===== GbProxy test START
=== test_gbproxy ===
--- Initialise SGSN ---

NS2 CALLBACK, prim 2, bvci 0x0000

Message for SGSN (NSEI=256 BVCI=0):
22 04 82 00 00 07 81 08 

--- Initialise BSS 1 ---

Setup NS-VC: NSEI 0x1000(4096)

NS2 CALLBACK, prim 2, bvci 0x0000

PROCESSING BVC_RESET from NSEI 4096
22 04 82 00 00 07 81 08 08 88 11 22 33 40 50 60 10 00 

NS2 CALLBACK, prim 0, msg length 18, bvci 0x0000
22 04 82 00 00 07 81 08 08 88 11 22 33 40 50 60 10 00 

Message for BSS (NSEI=4096 BVCI=0):
23 04 82 00 00 

Setup BSSGP: BVCI 0x1002(4098)

PROCESSING BVC_RESET from NSEI 4096
22 04 82 10 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

NS2 CALLBACK, prim 0, msg length 18, bvci 0x0000
22 04 82 10 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

NS2 UD REQUEST, prim 0, msg length 18, bvci 0x0000
22 04 82 10 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

Message for SGSN (NSEI=256 BVCI=0):
[L2]> [L3]> 22 04 82 10 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

Peers:
  NSEI 4096, BVCI 4098, not blocked, RAI 112-332-16464-96
PROCESSING BVC_RESET_ACK from NSEI 256
23 04 82 10 02 

NS2 CALLBACK, prim 0, msg length 5, bvci 0x0000
23 04 82 10 02 

NS2 UD REQUEST, prim 0, msg length 5, bvci 0x0000
23 04 82 10 02 

Message for BSS (NSEI=4096 BVCI=0):
[L2]> [L3]> 23 04 82 10 02 

--- Initialise BSS 2 ---

Setup NS-VC: NSEI 0x2000(8192)

NS2 CALLBACK, prim 2, bvci 0x0000

PROCESSING BVC_RESET from NSEI 8192
22 04 82 00 00 07 81 08 08 88 11 22 33 40 50 60 10 00 

NS2 CALLBACK, prim 0, msg length 18, bvci 0x0000
22 04 82 00 00 07 81 08 08 88 11 22 33 40 50 60 10 00 

Message for BSS (NSEI=8192 BVCI=0):
23 04 82 00 00 

Setup BSSGP: BVCI 0x2002(8194)

PROCESSING BVC_RESET from NSEI 8192
22 04 82 20 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

NS2 CALLBACK, prim 0, msg length 18, bvci 0x0000
22 04 82 20 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

NS2 UD REQUEST, prim 0, msg length 18, bvci 0x0000
22 04 82 20 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

Message for SGSN (NSEI=256 BVCI=0):
[L2]> [L3]> 22 04 82 20 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

Peers:
  NSEI 8192, BVCI 8194, not blocked, RAI 112-332-16464-96
  NSEI 4096, BVCI 4098, not blocked, RAI 112-332-16464-96
PROCESSING BVC_RESET_ACK from NSEI 256
23 04 82 20 02 

NS2 CALLBACK, prim 0, msg length 5, bvci 0x0000
23 04 82 20 02 

NS2 UD REQUEST, prim 0, msg length 5, bvci 0x0000
23 04 82 20 02 

Message for BSS (NSEI=8192 BVCI=0):
[L2]> [L3]> 23 04 82 20 02 

--- Reset BSS 1 with a new BVCI ---

Setup BSSGP: BVCI 0x1012(4114)

PROCESSING BVC_RESET from NSEI 4096
22 04 82 10 12 07 81 08 08 88 11 22 33 40 50 60 10 00 

NS2 CALLBACK, prim 0, msg length 18, bvci 0x0000
22 04 82 10 12 07 81 08 08 88 11 22 33 40 50 60 10 00 

NS2 UD REQUEST, prim 0, msg length 18, bvci 0x0000
22 04 82 10 12 07 81 08 08 88 11 22 33 40 50 60 10 00 

Message for SGSN (NSEI=256 BVCI=0):
[L2]> [L3]> 22 04 82 10 12 07 81 08 08 88 11 22 33 40 50 60 10 00 

Peers:
  NSEI 8192, BVCI 8194, not blocked, RAI 112-332-16464-96
  NSEI 4096, BVCI 4098, not blocked, RAI 112-332-16464-96
  NSEI 4096, BVCI 4114, not blocked, RAI 112-332-16464-96
PROCESSING BVC_RESET_ACK from NSEI 256
23 04 82 10 12 

NS2 CALLBACK, prim 0, msg length 5, bvci 0x0000
23 04 82 10 12 

NS2 UD REQUEST, prim 0, msg length 5, bvci 0x0000
23 04 82 10 12 

Message for BSS (NSEI=4096 BVCI=0):
[L2]> [L3]> 23 04 82 10 12 

--- Reset BSS 1 with the old BVCI ---

Setup BSSGP: BVCI 0x1002(4098)

PROCESSING BVC_RESET from NSEI 4096
22 04 82 10 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

NS2 CALLBACK, prim 0, msg length 18, bvci 0x0000
22 04 82 10 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

NS2 UD REQUEST, prim 0, msg length 18, bvci 0x0000
22 04 82 10 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

Message for SGSN (NSEI=256 BVCI=0):
[L2]> [L3]> 22 04 82 10 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

Peers:
  NSEI 8192, BVCI 8194, not blocked, RAI 112-332-16464-96
  NSEI 4096, BVCI 4098, not blocked, RAI 112-332-16464-96
  NSEI 4096, BVCI 4114, not blocked, RAI 112-332-16464-96
PROCESSING BVC_RESET_ACK from NSEI 256
23 04 82 10 02 

NS2 CALLBACK, prim 0, msg length 5, bvci 0x0000
23 04 82 10 02 

NS2 UD REQUEST, prim 0, msg length 5, bvci 0x0000
23 04 82 10 02 

Message for BSS (NSEI=4096 BVCI=0):
[L2]> [L3]> 23 04 82 10 02 

--- Reset BSS 1 with the old BVCI again ---

Setup BSSGP: BVCI 0x1002(4098)

PROCESSING BVC_RESET from NSEI 4096
22 04 82 10 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

NS2 CALLBACK, prim 0, msg length 18, bvci 0x0000
22 04 82 10 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

NS2 UD REQUEST, prim 0, msg length 18, bvci 0x0000
22 04 82 10 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

Message for SGSN (NSEI=256 BVCI=0):
[L2]> [L3]> 22 04 82 10 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

Peers:
  NSEI 8192, BVCI 8194, not blocked, RAI 112-332-16464-96
  NSEI 4096, BVCI 4098, not blocked, RAI 112-332-16464-96
  NSEI 4096, BVCI 4114, not blocked, RAI 112-332-16464-96
PROCESSING BVC_RESET_ACK from NSEI 256
23 04 82 10 02 

NS2 CALLBACK, prim 0, msg length 5, bvci 0x0000
23 04 82 10 02 

NS2 UD REQUEST, prim 0, msg length 5, bvci 0x0000
23 04 82 10 02 

Message for BSS (NSEI=4096 BVCI=0):
[L2]> [L3]> 23 04 82 10 02 

--- Send message from BSS 1 to SGSN, BVCI 0x1012 ---

PROCESSING (null) from NSEI 4096


NS2 CALLBACK, prim 0, msg length 0, bvci 0x1012


NS2 UD REQUEST, prim 0, msg length 0, bvci 0x1012


Message for SGSN (NSEI=256 BVCI=4114):
[L2]> [L3]> 

--- Send message from SGSN to BSS 1, BVCI 0x1012 ---

PROCESSING (null) from NSEI 256


NS2 CALLBACK, prim 0, msg length 0, bvci 0x1012


NS2 UD REQUEST, prim 0, msg length 0, bvci 0x1012


Message for BSS (NSEI=4096 BVCI=4114):
[L2]> [L3]> 

--- Send message from BSS 1 to SGSN, BVCI 0x1002 ---

PROCESSING (null) from NSEI 4096


NS2 CALLBACK, prim 0, msg length 0, bvci 0x1012


NS2 UD REQUEST, prim 0, msg length 0, bvci 0x1012


Message for SGSN (NSEI=256 BVCI=4114):
[L2]> [L3]> 

--- Send message from SGSN to BSS 1, BVCI 0x1002 ---

PROCESSING (null) from NSEI 256


NS2 CALLBACK, prim 0, msg length 0, bvci 0x1012


NS2 UD REQUEST, prim 0, msg length 0, bvci 0x1012


Message for BSS (NSEI=4096 BVCI=4114):
[L2]> [L3]> 

--- Send message from BSS 2 to SGSN, BVCI 0x2002 ---

PROCESSING (null) from NSEI 4096


NS2 CALLBACK, prim 0, msg length 0, bvci 0x2002


NS2 UD REQUEST, prim 0, msg length 0, bvci 0x2002


Message for SGSN (NSEI=256 BVCI=8194):
[L2]> [L3]> 

--- Send message from SGSN to BSS 2, BVCI 0x2002 ---

PROCESSING (null) from NSEI 256


NS2 CALLBACK, prim 0, msg length 0, bvci 0x2002


NS2 UD REQUEST, prim 0, msg length 0, bvci 0x2002


Message for BSS (NSEI=8192 BVCI=8194):
[L2]> [L3]> 

--- Reset BSS 1 with the old BVCI on BSS2's link ---

Setup BSSGP: BVCI 0x1002(4098)

PROCESSING BVC_RESET from NSEI 4096
22 04 82 10 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

NS2 CALLBACK, prim 0, msg length 18, bvci 0x0000
22 04 82 10 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

NS2 UD REQUEST, prim 0, msg length 18, bvci 0x0000
22 04 82 10 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

Message for SGSN (NSEI=256 BVCI=0):
[L2]> [L3]> 22 04 82 10 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

Peers:
  NSEI 8192, BVCI 8194, not blocked, RAI 112-332-16464-96
    NSEI mismatch                   : 1
  NSEI 4096, BVCI 4098, not blocked, RAI 112-332-16464-96
  NSEI 4096, BVCI 4114, not blocked, RAI 112-332-16464-96
Gbproxy global:
PROCESSING BVC_RESET_ACK from NSEI 256
23 04 82 10 02 

NS2 CALLBACK, prim 0, msg length 5, bvci 0x0000
23 04 82 10 02 

NS2 UD REQUEST, prim 0, msg length 5, bvci 0x0000
23 04 82 10 02 

Message for BSS (NSEI=4096 BVCI=0):
[L2]> [L3]> 23 04 82 10 02 

--- Send message from BSS 1 to SGSN, BVCI 0x1002 ---

PROCESSING (null) from NSEI 4096


NS2 CALLBACK, prim 0, msg length 0, bvci 0x1012


NS2 UD REQUEST, prim 0, msg length 0, bvci 0x1012


Message for SGSN (NSEI=256 BVCI=4114):
[L2]> [L3]> 

--- Send message from SGSN to BSS 1, BVCI 0x1002 ---

PROCESSING (null) from NSEI 256


NS2 CALLBACK, prim 0, msg length 0, bvci 0x1012


NS2 UD REQUEST, prim 0, msg length 0, bvci 0x1012


Message for BSS (NSEI=4096 BVCI=4114):
[L2]> [L3]> 

--- Send message from SGSN to BSS 1, BVCI 0x10ff (invalid) ---

PROCESSING (null) from NSEI 256


NS2 CALLBACK, prim 0, msg length 0, bvci 0x10ff


Message for SGSN (NSEI=256 BVCI=0):
41 07 81 05 04 82 10 ff 15 80 

Peers:
  NSEI 8192, BVCI 8194, not blocked, RAI 112-332-16464-96
    NSEI mismatch                   : 1
  NSEI 4096, BVCI 4098, not blocked, RAI 112-332-16464-96
Gbproxy global:
    Invalid BVC Identifier          : 1
=== test_gbproxy_ident_changes ===
--- Initialise SGSN ---

NS2 CALLBACK, prim 2, bvci 0x0000

Message for SGSN (NSEI=256 BVCI=0):
22 04 82 00 00 07 81 08 

--- Initialise BSS 1 ---

Setup NS-VC: NSEI 0x1000(4096)

NS2 CALLBACK, prim 2, bvci 0x0000

PROCESSING BVC_RESET from NSEI 4096
22 04 82 00 00 07 81 08 08 88 11 22 33 40 50 60 10 00 

NS2 CALLBACK, prim 0, msg length 18, bvci 0x0000
22 04 82 00 00 07 81 08 08 88 11 22 33 40 50 60 10 00 

Message for BSS (NSEI=4096 BVCI=0):
23 04 82 00 00 

--- Setup BVCI 1 ---

Setup BSSGP: BVCI 0x1002(4098)

PROCESSING BVC_RESET from NSEI 4096
22 04 82 10 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

NS2 CALLBACK, prim 0, msg length 18, bvci 0x0000
22 04 82 10 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

NS2 UD REQUEST, prim 0, msg length 18, bvci 0x0000
22 04 82 10 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

Message for SGSN (NSEI=256 BVCI=0):
[L2]> [L3]> 22 04 82 10 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

PROCESSING BVC_RESET_ACK from NSEI 256
23 04 82 10 02 

NS2 CALLBACK, prim 0, msg length 5, bvci 0x0000
23 04 82 10 02 

NS2 UD REQUEST, prim 0, msg length 5, bvci 0x0000
23 04 82 10 02 

Message for BSS (NSEI=4096 BVCI=0):
[L2]> [L3]> 23 04 82 10 02 

Peers:
  NSEI 4096, BVCI 4098, not blocked, RAI 112-332-16464-96
--- Setup BVCI 2 ---

Setup BSSGP: BVCI 0x2002(8194)

PROCESSING BVC_RESET from NSEI 4096
22 04 82 20 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

NS2 CALLBACK, prim 0, msg length 18, bvci 0x0000
22 04 82 20 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

NS2 UD REQUEST, prim 0, msg length 18, bvci 0x0000
22 04 82 20 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

Message for SGSN (NSEI=256 BVCI=0):
[L2]> [L3]> 22 04 82 20 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

PROCESSING BVC_RESET_ACK from NSEI 256
23 04 82 20 02 

NS2 CALLBACK, prim 0, msg length 5, bvci 0x0000
23 04 82 20 02 

NS2 UD REQUEST, prim 0, msg length 5, bvci 0x0000
23 04 82 20 02 

Message for BSS (NSEI=4096 BVCI=0):
[L2]> [L3]> 23 04 82 20 02 

Peers:
  NSEI 4096, BVCI 4098, not blocked, RAI 112-332-16464-96
  NSEI 4096, BVCI 8194, not blocked, RAI 112-332-16464-96
--- Send message from BSS 1 to SGSN and back, BVCI 1 ---

PROCESSING (null) from NSEI 4096


NS2 CALLBACK, prim 0, msg length 0, bvci 0x1002


NS2 UD REQUEST, prim 0, msg length 0, bvci 0x1002


Message for SGSN (NSEI=256 BVCI=4098):
[L2]> [L3]> 

PROCESSING (null) from NSEI 256


NS2 CALLBACK, prim 0, msg length 0, bvci 0x1002


NS2 UD REQUEST, prim 0, msg length 0, bvci 0x1002


Message for BSS (NSEI=4096 BVCI=4098):
[L2]> [L3]> 

--- Send message from BSS 1 to SGSN and back, BVCI 2 ---

PROCESSING (null) from NSEI 4096


NS2 CALLBACK, prim 0, msg length 0, bvci 0x2002


NS2 UD REQUEST, prim 0, msg length 0, bvci 0x2002


Message for SGSN (NSEI=256 BVCI=8194):
[L2]> [L3]> 

PROCESSING (null) from NSEI 256


NS2 CALLBACK, prim 0, msg length 0, bvci 0x2002


NS2 UD REQUEST, prim 0, msg length 0, bvci 0x2002


Message for BSS (NSEI=4096 BVCI=8194):
[L2]> [L3]> 

--- Change NSEI ---

Setup NS-VC: NSEI 0x2000(8192)

NS2 CALLBACK, prim 2, bvci 0x0000

PROCESSING BVC_RESET from NSEI 8192
22 04 82 00 00 07 81 08 08 88 11 22 33 40 50 60 10 00 

NS2 CALLBACK, prim 0, msg length 18, bvci 0x0000
22 04 82 00 00 07 81 08 08 88 11 22 33 40 50 60 10 00 

Message for BSS (NSEI=8192 BVCI=0):
23 04 82 00 00 

--- Setup BVCI 1 ---

Setup BSSGP: BVCI 0x1002(4098)

PROCESSING BVC_RESET from NSEI 8192
22 04 82 10 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

NS2 CALLBACK, prim 0, msg length 18, bvci 0x0000
22 04 82 10 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

NS2 UD REQUEST, prim 0, msg length 18, bvci 0x0000
22 04 82 10 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

Message for SGSN (NSEI=256 BVCI=0):
[L2]> [L3]> 22 04 82 10 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

PROCESSING BVC_RESET_ACK from NSEI 256
23 04 82 10 02 

NS2 CALLBACK, prim 0, msg length 5, bvci 0x0000
23 04 82 10 02 

NS2 UD REQUEST, prim 0, msg length 5, bvci 0x0000
23 04 82 10 02 

Message for BSS (NSEI=8192 BVCI=0):
[L2]> [L3]> 23 04 82 10 02 

Peers:
  NSEI 8192, BVCI 4098, not blocked, RAI 112-332-16464-96
    NSEI mismatch                   : 1
  NSEI 4096, BVCI 8194, not blocked, RAI 112-332-16464-96
--- Setup BVCI 3 ---

Setup BSSGP: BVCI 0x3002(12290)

PROCESSING BVC_RESET from NSEI 8192
22 04 82 30 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

NS2 CALLBACK, prim 0, msg length 18, bvci 0x0000
22 04 82 30 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

NS2 UD REQUEST, prim 0, msg length 18, bvci 0x0000
22 04 82 30 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

Message for SGSN (NSEI=256 BVCI=0):
[L2]> [L3]> 22 04 82 30 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

PROCESSING BVC_RESET_ACK from NSEI 256
23 04 82 30 02 

NS2 CALLBACK, prim 0, msg length 5, bvci 0x0000
23 04 82 30 02 

NS2 UD REQUEST, prim 0, msg length 5, bvci 0x0000
23 04 82 30 02 

Message for BSS (NSEI=8192 BVCI=0):
[L2]> [L3]> 23 04 82 30 02 

Peers:
  NSEI 8192, BVCI 4098, not blocked, RAI 112-332-16464-96
    NSEI mismatch                   : 1
  NSEI 8192, BVCI 12290, not blocked, RAI 112-332-16464-96
  NSEI 4096, BVCI 8194, not blocked, RAI 112-332-16464-96
--- Send message from BSS 1 to SGSN and back, BVCI 1 ---

PROCESSING (null) from NSEI 8192


NS2 CALLBACK, prim 0, msg length 0, bvci 0x1002


NS2 UD REQUEST, prim 0, msg length 0, bvci 0x1002


Message for SGSN (NSEI=256 BVCI=4098):
[L2]> [L3]> 

PROCESSING (null) from NSEI 256


NS2 CALLBACK, prim 0, msg length 0, bvci 0x1002


NS2 UD REQUEST, prim 0, msg length 0, bvci 0x1002


Message for BSS (NSEI=8192 BVCI=4098):
[L2]> [L3]> 

--- Send message from BSS 1 to SGSN and back, BVCI 2  (should fail) ---

PROCESSING (null) from NSEI 8192


NS2 CALLBACK, prim 0, msg length 0, bvci 0x2002


NS2 UD REQUEST, prim 0, msg length 0, bvci 0x2002


Message for SGSN (NSEI=256 BVCI=8194):
[L2]> [L3]> 

Peers:
  NSEI 8192, BVCI 4098, not blocked, RAI 112-332-16464-96
    NSEI mismatch                   : 1
  NSEI 8192, BVCI 12290, not blocked, RAI 112-332-16464-96
  NSEI 4096, BVCI 8194, not blocked, RAI 112-332-16464-96
    NSEI mismatch                   : 1
PROCESSING (null) from NSEI 256


NS2 CALLBACK, prim 0, msg length 0, bvci 0x2002


NS2 UD REQUEST, prim 0, msg length 0, bvci 0x2002


Message for BSS (NSEI=4096 BVCI=8194):
[L2]> [L3]> 

Peers:
  NSEI 8192, BVCI 4098, not blocked, RAI 112-332-16464-96
    NSEI mismatch                   : 1
  NSEI 8192, BVCI 12290, not blocked, RAI 112-332-16464-96
  NSEI 4096, BVCI 8194, not blocked, RAI 112-332-16464-96
    NSEI mismatch                   : 1
--- Send message from BSS 1 to SGSN and back, BVCI 3 ---

PROCESSING (null) from NSEI 4096


NS2 CALLBACK, prim 0, msg length 0, bvci 0x3002


NS2 UD REQUEST, prim 0, msg length 0, bvci 0x3002


Message for SGSN (NSEI=256 BVCI=12290):
[L2]> [L3]> 

PROCESSING (null) from NSEI 256


NS2 CALLBACK, prim 0, msg length 0, bvci 0x3002


NS2 UD REQUEST, prim 0, msg length 0, bvci 0x3002


Message for BSS (NSEI=8192 BVCI=12290):
[L2]> [L3]> 

Gbproxy global:
Peers:
  NSEI 8192, BVCI 4098, not blocked, RAI 112-332-16464-96
    NSEI mismatch                   : 1
  NSEI 8192, BVCI 12290, not blocked, RAI 112-332-16464-96
    NSEI mismatch                   : 1
  NSEI 4096, BVCI 8194, not blocked, RAI 112-332-16464-96
    NSEI mismatch                   : 1
===== GbProxy test END

